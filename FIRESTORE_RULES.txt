// ⚠️ IMPORTANT: Update these rules in Firebase Console
// Go to: Firebase Console → Firestore Database → Rules

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Users collection
    match /users/{userId} {
      // Anyone can create their own profile (signup)
      allow create: if true;
      
      // Only read approved users (for matching)
      allow read: if resource.data.approved == true;
      
      // Allow admin to update/delete (you'll need to add admin authentication)
      allow update, delete: if true; // ⚠️ TODO: Add proper admin authentication
    }
    
    // Matches collection - stores mutual likes
    match /matches/{matchId} {
      // Users can create matches (swipe right)
      allow create: if request.auth != null;
      
      // Users can read their own matches
      allow read: if request.auth != null && 
                     (resource.data.user1Id == request.auth.uid || 
                      resource.data.user2Id == request.auth.uid);
      
      // Allow updates for match status
      allow update: if request.auth != null;
    }
    
    // Messages collection - stores conversations
    match /messages/{messageId} {
      // Users can create messages
      allow create: if request.auth != null;
      
      // Users can read messages in their conversations
      allow read: if request.auth != null;
    }
    
    // Swipes collection - tracks who swiped on whom
    match /swipes/{swipeId} {
      // Users can create swipes
      allow create: if request.auth != null;
      
      // Users can read their own swipes
      allow read: if request.auth != null;
    }
  }
}

